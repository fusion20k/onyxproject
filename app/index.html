<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Workspace - Onyx</title>
    <link rel="icon" type="image/x-icon" href="../assets/favicon.ico">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/decision-workspace.css">
</head>
<body class="workspace-page">
    <div class="workspace-container">
        <!-- Main Content -->
        <main class="workspace-main">
            <!-- Loading State -->
            <div id="loading-state" class="workspace-state">
                <div class="workspace-content">
                    <p class="workspace-loading">Loading workspace...</p>
                </div>
            </div>

            <!-- Unauthorized State -->
            <div id="unauthorized-state" class="workspace-state" style="display: none;">
                <div class="workspace-content" style="text-align: center; padding-top: 120px;">
                    <h1 class="workspace-error-title">Access Denied</h1>
                    <p class="workspace-error-text">You must be logged in and have an active subscription.</p>
                    <a href="/invite" class="workspace-cta">Get Access</a>
                </div>
            </div>

            <!-- Unpaid State -->
            <div id="unpaid-state" class="workspace-state" style="display: none;">
                <div class="workspace-content" style="text-align: center; padding-top: 120px;">
                    <h1 class="workspace-error-title">Payment Required</h1>
                    <p class="workspace-error-text">Please complete payment to access your workspace.</p>
                    <a href="/payment" class="workspace-cta">Complete Payment</a>
                </div>
            </div>

            <!-- First-Time Experience -->
            <div id="first-time-state" class="workspace-state" style="display: none;">
                <div class="first-time-container">
                    <div class="first-time-header">
                        <h1>Tell Onyx what you're deciding.</h1>
                        <p class="first-time-subtitle">Get a real response, not a thread of opinions.</p>
                    </div>
                    
                    <div class="first-time-guidance">
                        <p>Start by pasting any context you already have — notes, screenshots, thoughts, or drafts.</p>
                        <p>The more context you provide, the sharper the feedback.</p>
                    </div>
                    
                    <div class="first-time-input-container">
                        <textarea id="first-message-input" class="message-textarea" placeholder="What decision are you stuck on? What's at stake if you choose wrong?"></textarea>
                        <div class="file-upload-zone" id="first-file-upload">
                            <input type="file" id="first-file-input" accept="image/png,image/jpeg,application/pdf" style="display: none;">
                            <button type="button" class="btn-attach" id="first-attach-btn">Attach file</button>
                            <span class="file-name" id="first-file-name"></span>
                        </div>
                        <button id="send-first-message" class="btn btn-primary">Send to Onyx</button>
                    </div>
                </div>
            </div>

            <!-- Main Workspace - Decision Analysis Layout -->
            <div id="workspace-state" class="workspace-state" style="display: none;">
                <div class="decision-workspace">
                    <!-- Header Bar -->
                    <header class="workspace-header">
                        <div class="workspace-header-left">
                            <h1 class="workspace-title"><a href="/app" class="workspace-title-link">Workspace</a></h1>
                        </div>
                        <div class="workspace-header-right">
                            <button class="user-menu-trigger" id="user-menu-main">
                                <span id="username-main">User</span>
                            </button>
                            <div class="user-menu-dropdown" id="user-dropdown-main" style="display: none;">
                                <div class="user-menu-item" data-action="library">Library</div>
                                <div class="user-menu-item" data-action="payment">Payment</div>
                                <div class="user-menu-item" data-action="logout">Logout</div>
                            </div>
                        </div>
                    </header>

                    <!-- No Active Decision State -->
                    <div id="no-decision-state" class="empty-decision-state" style="display: none;">
                        <h2>No active decision</h2>
                        <p>Start a new decision analysis to get Onyx's assessment.</p>
                        <a href="/app/new-decision.html" class="btn btn-primary">Start new decision</a>
                    </div>

                    <!-- Active Decision View -->
                    <div id="decision-view" class="decision-view" style="display: none;">
                        <div class="decision-layout">
                            <!-- Left Column: Main Content -->
                            <main class="decision-main">
                                <!-- Understanding Card -->
                                <section class="decision-card" id="understanding-card">
                                    <h2 class="card-title">Onyx's understanding of your situation</h2>
                                    
                                    <div id="understanding-display" class="understanding-content">
                                        <ul class="understanding-list">
                                            <li><strong>Goal:</strong> <span id="goal-text">—</span></li>
                                            <li><strong>Time horizon:</strong> <span id="time-horizon-text">—</span></li>
                                            <li><strong>Constraints:</strong> <span id="constraints-text">—</span></li>
                                            <li><strong>Options:</strong> <span id="options-text">—</span></li>
                                        </ul>
                                        
                                        <div class="card-actions">
                                            <button class="btn btn-primary" id="confirm-understanding-btn">This looks right</button>
                                            <button class="btn btn-ghost" id="edit-understanding-btn">Edit details</button>
                                        </div>
                                    </div>

                                    <div id="understanding-edit" class="understanding-edit" style="display: none;">
                                        <div class="form-group">
                                            <label>Goal</label>
                                            <input type="text" id="edit-goal" class="input">
                                        </div>
                                        <div class="form-group">
                                            <label>Time Horizon</label>
                                            <input type="text" id="edit-time-horizon" class="input" placeholder="e.g., 6 months, 1 year">
                                        </div>
                                        <div class="form-group">
                                            <label>Constraints</label>
                                            <textarea id="edit-constraints" class="input" rows="3" placeholder="One per line"></textarea>
                                        </div>
                                        <div class="form-group">
                                            <label>Risk Tolerance</label>
                                            <select id="edit-risk-tolerance" class="input">
                                                <option value="conservative">Conservative</option>
                                                <option value="balanced">Balanced</option>
                                                <option value="aggressive">Aggressive</option>
                                            </select>
                                        </div>
                                        <div class="card-actions">
                                            <button class="btn btn-primary" id="save-understanding-btn">Save changes</button>
                                            <button class="btn btn-ghost" id="cancel-edit-btn">Cancel</button>
                                        </div>
                                    </div>
                                </section>

                                <!-- Stress Tests Card -->
                                <section class="decision-card" id="stress-tests-card">
                                    <h2 class="card-title">How your options behave under stress</h2>
                                    
                                    <div id="options-container" class="options-grid">
                                        <!-- Options populated by JS -->
                                    </div>

                                    <p class="stress-test-note">Onyx perturbed your assumptions (±30–50%) to see how quickly each option fails.</p>
                                </section>

                                <!-- Analysis Card -->
                                <section class="decision-card" id="recommendation-card">
                                    <h2 class="card-title">Analysis</h2>
                                    
                                    <div class="recommendation-content">
                                        <div class="recommended-option">
                                            <span class="recommendation-label">Most robust option:</span>
                                            <h3 id="recommended-option-name">—</h3>
                                        </div>
                                        
                                        <p id="recommendation-reasoning" class="recommendation-text">—</p>
                                        
                                        <div class="card-actions" id="active-decision-actions">
                                            <button class="btn btn-primary" id="commit-decision-btn">Commit to this plan</button>
                                            <button class="btn btn-ghost" id="show-alternatives-btn">Show me why not the others</button>
                                        </div>
                                        
                                        <div class="card-actions" id="committed-decision-actions" style="display: none;">
                                            <button class="btn btn-secondary" id="back-to-library-btn">← Back to library</button>
                                            <button class="btn btn-ghost" id="delete-decision-btn">Delete decision</button>
                                        </div>

                                        <div id="alternatives-section" class="alternatives-section" style="display: none;">
                                            <h4>Why not the alternatives?</h4>
                                            <p id="alternatives-text">—</p>
                                        </div>
                                    </div>
                                </section>

                                <!-- Execution Plan Card -->
                                <section class="decision-card" id="execution-plan-card" style="display: none;">
                                    <h2 class="card-title">How to execute this decision</h2>
                                    
                                    <div class="execution-plan-content" id="execution-plan-content">
                                        <p id="execution-plan-text">—</p>
                                    </div>
                                </section>

                                <!-- Optional Followup Thread -->
                                <section class="decision-card followup-card" id="followup-card" style="display: none;">
                                    <h2 class="card-title">Ask Onyx a follow-up</h2>
                                    
                                    <div id="followup-thread" class="followup-thread">
                                        <!-- Messages populated by JS -->
                                    </div>

                                    <div class="followup-input-container">
                                        <textarea id="followup-input" class="input" placeholder="What else do you want to know?" rows="3"></textarea>
                                        <button class="btn btn-primary" id="send-followup-btn">Send</button>
                                    </div>
                                </section>
                            </main>

                            <!-- Right Sidebar: Summary -->
                            <aside class="decision-sidebar">
                                <div class="summary-card">
                                    <h3 class="summary-title">Decision summary</h3>
                                    
                                    <div class="summary-field">
                                        <label>Goal</label>
                                        <p id="sidebar-goal">—</p>
                                    </div>
                                    
                                    <div class="summary-field">
                                        <label>Time horizon</label>
                                        <p id="sidebar-time-horizon">—</p>
                                    </div>
                                    
                                    <div class="summary-field">
                                        <label>Primary metric</label>
                                        <p id="sidebar-metric">—</p>
                                    </div>
                                    
                                    <div class="summary-field">
                                        <label>Risk tolerance</label>
                                        <p id="sidebar-risk">—</p>
                                    </div>

                                    <div class="outcome-tracker">
                                        <h4>Outcome tracker</h4>
                                        <p id="committed-date" class="outcome-empty">Not committed yet</p>
                                    </div>
                                </div>
                            </aside>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- Custom Dialog Modal -->
    <div id="custom-dialog" class="custom-dialog" style="display: none;">
        <div class="custom-dialog-overlay"></div>
        <div class="custom-dialog-content">
            <div class="custom-dialog-body">
                <p id="custom-dialog-message"></p>
            </div>
            <div class="custom-dialog-actions">
                <button class="btn btn-primary" id="custom-dialog-confirm">OK</button>
                <button class="btn btn-ghost" id="custom-dialog-cancel" style="display: none;">Cancel</button>
            </div>
        </div>
    </div>

    <script src="../js/decision-workspace.js"></script>
</body>
</html>
  
